%利用离差最大化原理求状态指标的权重
%已有论文推导出权重公式，下面直接进行权重求解

%state_index1 指标1（电压稳定裕度）

%求分子
index_data = xlsread("state_index.xls");
c1 = 0;
sum1_fenzi = zeros(1,3);
for k = 1:3
    a1 = index_data(:,k);
    b1 = a1(1:29);
   
    for i = 1:length(b1)
        for j = 1:length(b1)
            c1 = abs(b1(i)-b1(j));
            sum1_fenzi(k) = sum1_fenzi(k) + c1;
        end
    end
end

%求分母
sum1_fenmu = 0;
for x = 1:3
    d1 = sum1_fenzi(x).*sum1_fenzi(x);
    sum1_fenmu = sum1_fenmu + d1;
end

%分配权重
e = zeros(1,3);
W = zeros(1,3);
sum_e = 0;
for y = 1:length(W)
    e(y) = sum1_fenzi(y)./sum1_fenmu;
end
for z = 1:3
    sum_e = sum_e + e(z);
end
W(1) = e(1)./sum_e;
W(2) = e(2)./sum_e;
W(3) = e(3)./sum_e;
xlswrite('state_index.xls',W,'sheet1','A31');
    

    

        

        
        