function entropySum = networkEntropy(mpc,disnode)
%NETWORKENTROPY 此处显示有关此函数的摘要
%   计算电网结构熵
define_constants;
if nargin == 2
    node_idx = mpc.bus(:,1); %[1-39]的节点名名称        
end

%将mpc.branch矩阵中的第一列和第二列取出
connectionBus = mpc.branch(:,[1,2]);%获取初始网络连接情况
entropySum = zeros(size(disnode));
entropy = 0;
% duSum = size(connectionBus,1)*2; %得到节点度总和

%节点破坏后的连接情况
for i = 1:length(disnode)
    id = connectionBus(:,1) == disnode(i)|connectionBus(:,2) == disnode(i);
    connectionBus(id,:) = [];
    value = [];
    for idx = 1:length(node_idx)
        duSum = size(connectionBus,1)*2; %得到节点度总和
        value(idx) = length(find(connectionBus==idx))/duSum;%得到每个节点的节点度
    a = value;
    end
    
    for j = 1:length(value)
        if value(j) == 0
            continue
        else
            entropy = -value(j)*log(value(j));
            entropySum(i) = entropySum(i) + entropy;
    b = entropySum;
        end
    end      
end

    
    


    
    
    
    
    