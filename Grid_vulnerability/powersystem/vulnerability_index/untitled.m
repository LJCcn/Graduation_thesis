clc;
define_constants;
mpc = loadcase('case118');
a = mpc.branch(:,[1,2,4]);
N = 118;
value = zeros(N);
v = zeros(N); 
D = zeros(N); 
% disnode = [2 3 5 6 7];
% for j = 1:length(disnode)
%     id = a(:,1) == disnode(j)|a(:,2) == disnode(j)|a(:,3) == disnode(j);
%     a(id,:) = [];
    for i = 1:length(a)
        b = a(i,:);
        value(b(1),b(2)) = b(3);
    end
    value = value+value';
    value = tril(value);
    value = sparse(value);
    dist = graphallshortestpaths(value,'directed',false);
    Ldist = tril(dist);
    d = 1./Ldist;
    e = find(d(:)==Inf);
    d(e)=0;
    result = sum(sum(d))/(N*(N-1))
% end
